

### CRF

##### 什么是CRF？在命名实体识别中是如何起作用的？

- Conditional Random Fields，给定一组输入序列的条件下，另一组输出序列的条件概率模型

**什么是CRF**

- CRF是HMM和MEMM的条件放松版本

  - HMM具有马尔科夫性和观测独立性
  - MEMM改变了HMM发射的方向，同时破坏了观测独立性，但是他存在label bias problem
  - CRF 在状态转移中是无向图，具有全局归一性

  ![img](/home/BasicData/zk/工作/zk_note/img/crf1.png)

##### 在命名实体识别中如何起作用

- 在NER任务中，观测序列X是对应的单词序列，Y是标注序列
- $y_i$的标注不仅受到$x_i$的影响，还受到整个X序列的影响。同时还受到$y_{i-1}$和$y_{i+1}$的影响，目标求解: $P(y_i|y_{i-1},y_{i+1},X)$
  - 举例："我们住在XX" 中的XX是一个地名,“XX市”可能是一个地名，"王XX"可能是一个人名
  - 这里$y_i$的选取依赖两个特征函数，一个是转移特征函数，一个发射特征函数
- 这里要使得真实的标注序列概率最大化 :$Loss = \cfrac{P_{real}}{P_1+P_2+...+P_N}$，通过标注的先验和极大似然估计求解
- 转移特征函数和发射特征函数通过"标注规则"和"转移规则"的设定，进行学习

##### BERT和CRF是如何配合？

- 通过BERT来学习序列的标注特征，从而得到一个状态分数，省去了“人工规则”的设定，能够学习某个位置可能对应的实体标注
- BERT学习“状态特征矩阵”到的序列标注，CRF用来学习“转移分数矩阵”，两者约束共同完成标注任务

##### Viterbi算法求解CRF?

- 类似动态规划的思想，记住每一步的最优路径，然后以此进行下一步的路径



