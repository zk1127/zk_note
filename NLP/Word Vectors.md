### 蒙特卡罗采样



- 蒙特卡洛：

  - 抽象定义：通过概率模型的随机抽样来进行近似数值计算的方法,比如估计$\pi$

  - 简单理解：目标是求解某个**参量**，直接求解出现困难，将其构建为一个合适的概率模型，对这个模型进行大量的采样和统计实验，使它的某些**统计参量**正好待求问题的解，只需要把这个参量的值统计出来，那么问题的解就是估计的值。

  - 蒙特卡洛的解法：

    - 拒绝-接受采样:这种方法适用于$p(x)$极度复杂不规则的情况

    - 利用$q(x)$进行采样，然后设置一定概率来接受和保留它

      ![img](https://pic2.zhimg.com/80/v2-c6015aa0d342bc1598c460bbd9fb8311_720w.jpg)

- 马尔可夫蒙特卡罗法：以马尔科夫链为概率模型的蒙特卡洛法，MCMC是构建一个马尔科夫链使其平稳分布就是要抽样的分布, *马尔可夫蒙特卡洛法可以降低采样的难度，提高采样的效率*

  - 马尔科夫链特征:

    - 不可约:每个状态都能去到
    - 非周期：返回时间公约数是1
    - 正常返：离开此状态有限步会返回
    - 零常返: 离开此状态能返回，但需要无穷多步
    - 非常返：离开此状态有限步不一定能回来
    - 遍历定理: **不可约**，**非周期**，**正常返** $\rightarrow$ 有唯一平稳的分布

  - 求解出这个平稳分布就是目标分布

  - 求解需用到细致平稳条件: $\pi(i)p_{ij}=\pi_{j}p_{ji}$, π(x)是马尔科夫链的平稳分布。从*i*转移出去到j而丢失的概率质量，恰好会被从*j*转移回*i*的概率质量补充回来，所以状态i上的概率质量*π*(*i*)是稳定的，从而*π*(*x*)是马尔科夫链的平稳分布。

  - 吉比斯采样的目标是从一个已知的目标分布$p(x)$进行采样，并估计某个函数的期望值。$p(x)$是一个多维的随机分布，$p(x)$的联合分布复杂，难以采样，但是能够很容易采样条件概率分布

    ![img](../img/gibbs.png)